INFO:root:*** PARAMETERS ***
INFO:root:{'adj_mat_time_window': 1,
 'class_weights': [0.05, 0.95],
 'comments': ['comments'],
 'data': 'seir',
 'data_loading_params': {'batch_size': 1, 'num_workers': 0},
 'dev_proportion': 0.2,
 'device': 'cuda',
 'early_stop_patience': 50,
 'eval_after_epochs': 6,
 'gcn_parameters': {'cls_feats': 1024,
                    'cls_feats_max': 1024,
                    'cls_feats_min': 100,
                    'feats_per_node': 100,
                    'feats_per_node_max': 256,
                    'feats_per_node_min': 50,
                    'k_top_grcu': 200,
                    'layer_1_feats': 51,
                    'layer_1_feats_max': 200,
                    'layer_1_feats_min': 10,
                    'layer_2_feats': 51,
                    'layer_2_feats_same_as_l1': True,
                    'lstm_l1_feats': 157,
                    'lstm_l1_feats_max': 200,
                    'lstm_l1_feats_min': 10,
                    'lstm_l1_layers': 1,
                    'lstm_l2_feats': 157,
                    'lstm_l2_feats_same_as_l1': True,
                    'lstm_l2_layers': 1,
                    'num_layers': 2},
 'learning_rate': 0.005,
 'learning_rate_max': 0.1,
 'learning_rate_min': 0.0001,
 'model': 'egcn_o',
 'negative_mult_test': 20,
 'negative_mult_training': 10,
 'num_epochs': 100,
 'num_hist_steps': 5,
 'num_hist_steps_max': 10,
 'num_hist_steps_min': 2,
 'rank': 0,
 'save_node_embeddings': False,
 'save_state': True,
 'seed': 1234,
 'seir_args': <utils.Namespace object at 0x7f1b7db3f700>,
 'smart_neg_sampling': True,
 'steps_accum_gradients': 1,
 'target_class': 1,
 'target_measure': 'MAP',
 'task': 'link_pred',
 'train_proportion': 0.7,
 'use_1_hot_node_feats': True,
 'use_2_hot_node_feats': False,
 'use_cuda': True,
 'use_logfile': True,
 'wsize': 1}
INFO:root:
INFO:root:################ TRAIN epoch 0 ###################
INFO:root:TRAIN mean losses tensor(0.0879, device='cuda:0')
INFO:root:TRAIN mean errors 0.7150160670280457
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.10048495337113937
INFO:root:TRAIN tp {0: tensor(26320, device='cuda:0'), 1: tensor(8464, device='cuda:0')},fn {0: tensor(84640, device='cuda:0'), 1: tensor(2632, device='cuda:0')},fp {0: tensor(2632, device='cuda:0'), 1: tensor(84640, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.2850 - recall 0.2850 - f1 0.2850 
INFO:root:TRAIN measures for class 0 - precision 0.9091 - recall 0.2372 - f1 0.3762 
INFO:root:TRAIN measures for class 1 - precision 0.0909 - recall 0.7628 - f1 0.1625 
INFO:root:TRAIN measures@10 microavg - precision 0.2600 - recall 0.0001 - f1 0.0002 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0001 - f1 0.0002 
INFO:root:TRAIN measures@10 for class 1 - precision 0.0750 - recall 0.0003 - f1 0.0005 
INFO:root:TRAIN measures@100 microavg - precision 0.2580 - recall 0.0011 - f1 0.0021 
INFO:root:TRAIN measures@100 for class 0 - precision 0.9600 - recall 0.0009 - f1 0.0017 
INFO:root:TRAIN measures@100 for class 1 - precision 0.0825 - recall 0.0030 - f1 0.0057 
INFO:root:TRAIN measures@1000 microavg - precision 0.2620 - recall 0.0107 - f1 0.0206 
INFO:root:TRAIN measures@1000 for class 0 - precision 0.9170 - recall 0.0083 - f1 0.0164 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.0983 - recall 0.0354 - f1 0.0521 
INFO:root:TRAIN Total epoch time: 1.4434351054951549
INFO:root:################ TRAIN epoch 1 ###################
INFO:root:TRAIN mean losses tensor(0.0850, device='cuda:0')
INFO:root:TRAIN mean errors 0.9090909361839294
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.09612564943260393
INFO:root:TRAIN tp {0: tensor(0, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(110960, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(110960, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.0909 - recall 0.0909 - f1 0.0909 
INFO:root:TRAIN measures for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures for class 1 - precision 0.0909 - recall 1.0000 - f1 0.1667 
INFO:root:TRAIN measures@10 microavg - precision 0.1000 - recall 0.0000 - f1 0.0001 
INFO:root:TRAIN measures@10 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@100 microavg - precision 0.1100 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@100 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1100 - recall 0.0050 - f1 0.0095 
INFO:root:TRAIN measures@1000 microavg - precision 0.0966 - recall 0.0040 - f1 0.0076 
INFO:root:TRAIN measures@1000 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.0966 - recall 0.0435 - f1 0.0600 
INFO:root:TRAIN Total epoch time: 0.7943453881889582
INFO:root:################ TRAIN epoch 2 ###################
INFO:root:TRAIN mean losses tensor(0.0848, device='cuda:0')
INFO:root:TRAIN mean errors 0.9090909361839294
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.10596312370915044
INFO:root:TRAIN tp {0: tensor(0, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(110960, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(110960, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.0909 - recall 0.0909 - f1 0.0909 
INFO:root:TRAIN measures for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures for class 1 - precision 0.0909 - recall 1.0000 - f1 0.1667 
INFO:root:TRAIN measures@10 microavg - precision 0.0800 - recall 0.0000 - f1 0.0001 
INFO:root:TRAIN measures@10 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@10 for class 1 - precision 0.0800 - recall 0.0004 - f1 0.0007 
INFO:root:TRAIN measures@100 microavg - precision 0.1100 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@100 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1100 - recall 0.0050 - f1 0.0095 
INFO:root:TRAIN measures@1000 microavg - precision 0.1010 - recall 0.0041 - f1 0.0079 
INFO:root:TRAIN measures@1000 for class 0 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1010 - recall 0.0455 - f1 0.0627 
INFO:root:TRAIN Total epoch time: 0.712494526989758
INFO:root:################ TRAIN epoch 3 ###################
INFO:root:TRAIN mean losses tensor(0.0842, device='cuda:0')
INFO:root:TRAIN mean errors 0.9079275131225586
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.1075731812886021
INFO:root:TRAIN tp {0: tensor(142, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(110818, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(110818, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.0921 - recall 0.0921 - f1 0.0921 
INFO:root:TRAIN measures for class 0 - precision 1.0000 - recall 0.0013 - f1 0.0026 
INFO:root:TRAIN measures for class 1 - precision 0.0910 - recall 1.0000 - f1 0.1668 
INFO:root:TRAIN measures@10 microavg - precision 0.4625 - recall 0.0003 - f1 0.0006 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0003 - f1 0.0005 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1400 - recall 0.0006 - f1 0.0013 
INFO:root:TRAIN measures@100 microavg - precision 0.3162 - recall 0.0017 - f1 0.0033 
INFO:root:TRAIN measures@100 for class 0 - precision 1.0000 - recall 0.0013 - f1 0.0026 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1220 - recall 0.0055 - f1 0.0105 
INFO:root:TRAIN measures@1000 microavg - precision 0.1305 - recall 0.0055 - f1 0.0106 
INFO:root:TRAIN measures@1000 for class 0 - precision 1.0000 - recall 0.0013 - f1 0.0026 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1058 - recall 0.0477 - f1 0.0657 
INFO:root:TRAIN Total epoch time: 0.6891391854733229
INFO:root:################ TRAIN epoch 4 ###################
INFO:root:TRAIN mean losses tensor(0.0825, device='cuda:0')
INFO:root:TRAIN mean errors 0.8551157116889954
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.11141667254446078
INFO:root:TRAIN tp {0: tensor(6588, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(104372, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(104372, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.1449 - recall 0.1449 - f1 0.1449 
INFO:root:TRAIN measures for class 0 - precision 1.0000 - recall 0.0594 - f1 0.1121 
INFO:root:TRAIN measures for class 1 - precision 0.0961 - recall 1.0000 - f1 0.1753 
INFO:root:TRAIN measures@10 microavg - precision 0.5800 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1600 - recall 0.0007 - f1 0.0014 
INFO:root:TRAIN measures@100 microavg - precision 0.5570 - recall 0.0046 - f1 0.0091 
INFO:root:TRAIN measures@100 for class 0 - precision 1.0000 - recall 0.0045 - f1 0.0090 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1140 - recall 0.0051 - f1 0.0098 
INFO:root:TRAIN measures@1000 microavg - precision 0.5304 - recall 0.0413 - f1 0.0765 
INFO:root:TRAIN measures@1000 for class 0 - precision 1.0000 - recall 0.0405 - f1 0.0778 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1084 - recall 0.0488 - f1 0.0673 
INFO:root:TRAIN Total epoch time: 0.7273586532101035
INFO:root:################ TRAIN epoch 5 ###################
INFO:root:TRAIN mean losses tensor(0.0824, device='cuda:0')
INFO:root:TRAIN mean errors 0.7804204821586609
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.11584515152157115
INFO:root:TRAIN tp {0: tensor(15738, device='cuda:0'), 1: tensor(11063, device='cuda:0')},fn {0: tensor(95222, device='cuda:0'), 1: tensor(33, device='cuda:0')},fp {0: tensor(33, device='cuda:0'), 1: tensor(95222, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.2196 - recall 0.2196 - f1 0.2196 
INFO:root:TRAIN measures for class 0 - precision 0.9979 - recall 0.1418 - f1 0.2484 
INFO:root:TRAIN measures for class 1 - precision 0.1041 - recall 0.9970 - f1 0.1885 
INFO:root:TRAIN measures@10 microavg - precision 0.5700 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1400 - recall 0.0006 - f1 0.0013 
INFO:root:TRAIN measures@100 microavg - precision 0.5680 - recall 0.0047 - f1 0.0092 
INFO:root:TRAIN measures@100 for class 0 - precision 1.0000 - recall 0.0045 - f1 0.0090 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1360 - recall 0.0061 - f1 0.0117 
INFO:root:TRAIN measures@1000 microavg - precision 0.5420 - recall 0.0428 - f1 0.0793 
INFO:root:TRAIN measures@1000 for class 0 - precision 1.0000 - recall 0.0418 - f1 0.0802 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1176 - recall 0.0530 - f1 0.0731 
INFO:root:TRAIN Total epoch time: 0.6808151816949248
INFO:root:################ TRAIN epoch 6 ###################
INFO:root:TRAIN mean losses tensor(0.0799, device='cuda:0')
INFO:root:TRAIN mean errors 0.7222258448600769
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.11366251235266477
INFO:root:TRAIN tp {0: tensor(22808, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(88152, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(88152, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.2778 - recall 0.2778 - f1 0.2778 
INFO:root:TRAIN measures for class 0 - precision 1.0000 - recall 0.2056 - f1 0.3410 
INFO:root:TRAIN measures for class 1 - precision 0.1118 - recall 1.0000 - f1 0.2011 
INFO:root:TRAIN measures@10 microavg - precision 0.5800 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1600 - recall 0.0007 - f1 0.0014 
INFO:root:TRAIN measures@100 microavg - precision 0.5540 - recall 0.0045 - f1 0.0090 
INFO:root:TRAIN measures@100 for class 0 - precision 1.0000 - recall 0.0045 - f1 0.0090 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1080 - recall 0.0049 - f1 0.0093 
INFO:root:TRAIN measures@1000 microavg - precision 0.5567 - recall 0.0456 - f1 0.0843 
INFO:root:TRAIN measures@1000 for class 0 - precision 1.0000 - recall 0.0451 - f1 0.0862 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1134 - recall 0.0511 - f1 0.0705 
INFO:root:TRAIN Total epoch time: 0.7364204274490476
INFO:root:################ TRAIN epoch 7 ###################
INFO:root:TRAIN mean losses tensor(0.0769, device='cuda:0')
INFO:root:TRAIN mean errors 0.7204725742340088
INFO:root:TRAIN mean MRR 0.0 - mean MAP 0.11288706961477306
INFO:root:TRAIN tp {0: tensor(23022, device='cuda:0'), 1: tensor(11096, device='cuda:0')},fn {0: tensor(87938, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(87938, device='cuda:0')}
INFO:root:TRAIN measures microavg - precision 0.2795 - recall 0.2795 - f1 0.2795 
INFO:root:TRAIN measures for class 0 - precision 1.0000 - recall 0.2075 - f1 0.3437 
INFO:root:TRAIN measures for class 1 - precision 0.1120 - recall 1.0000 - f1 0.2015 
INFO:root:TRAIN measures@10 microavg - precision 0.5500 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 0 - precision 1.0000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@10 for class 1 - precision 0.1000 - recall 0.0005 - f1 0.0009 
INFO:root:TRAIN measures@100 microavg - precision 0.5590 - recall 0.0046 - f1 0.0091 
INFO:root:TRAIN measures@100 for class 0 - precision 1.0000 - recall 0.0045 - f1 0.0090 
INFO:root:TRAIN measures@100 for class 1 - precision 0.1180 - recall 0.0053 - f1 0.0102 
INFO:root:TRAIN measures@1000 microavg - precision 0.5565 - recall 0.0456 - f1 0.0843 
INFO:root:TRAIN measures@1000 for class 0 - precision 1.0000 - recall 0.0451 - f1 0.0862 
INFO:root:TRAIN measures@1000 for class 1 - precision 0.1130 - recall 0.0509 - f1 0.0702 
INFO:root:TRAIN Total epoch time: 0.6835817247629166
INFO:root:################ VALID epoch 7 ###################
INFO:root:VALID mean losses tensor(0.0621, device='cuda:0')
INFO:root:VALID mean errors 0.849006175994873
INFO:root:VALID mean MRR 0.14473225298550782 - mean MAP 0.05308379740094946
INFO:root:VALID tp {0: tensor(3443, device='cuda:0'), 1: tensor(1586, device='cuda:0')},fn {0: tensor(28277, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(28277, device='cuda:0')}
INFO:root:VALID measures microavg - precision 0.1510 - recall 0.1510 - f1 0.1510 
INFO:root:VALID measures for class 0 - precision 1.0000 - recall 0.1085 - f1 0.1958 
INFO:root:VALID measures for class 1 - precision 0.0531 - recall 1.0000 - f1 0.1009 
INFO:root:VALID measures@10 microavg - precision 0.5500 - recall 0.0010 - f1 0.0020 
INFO:root:VALID measures@10 for class 0 - precision 1.0000 - recall 0.0009 - f1 0.0019 
INFO:root:VALID measures@10 for class 1 - precision 0.1000 - recall 0.0019 - f1 0.0037 
INFO:root:VALID measures@100 microavg - precision 0.5200 - recall 0.0094 - f1 0.0184 
INFO:root:VALID measures@100 for class 0 - precision 1.0000 - recall 0.0095 - f1 0.0187 
INFO:root:VALID measures@100 for class 1 - precision 0.0400 - recall 0.0076 - f1 0.0127 
INFO:root:VALID measures@1000 microavg - precision 0.5177 - recall 0.0918 - f1 0.1560 
INFO:root:VALID measures@1000 for class 0 - precision 1.0000 - recall 0.0917 - f1 0.1680 
INFO:root:VALID measures@1000 for class 1 - precision 0.0500 - recall 0.0946 - f1 0.0654 
INFO:root:VALID Total epoch time: 41.385175397619605
INFO:root:################ TEST epoch 7 ###################
INFO:root:TEST batch 1 / 2 - partial error 0.8516 - partial loss 0.0621 - partial MRR  0.1498 - partial MAP 0.0516
INFO:root:TEST batch 1 / 2 -  partial tp {0: tensor(1071, device='cuda:0'), 1: tensor(506, device='cuda:0')},fn {0: tensor(9049, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(9049, device='cuda:0')}
INFO:root:TEST batch 1 / 2 - measures partial microavg - precision 0.1484 - recall 0.1484 - f1 0.1484 
INFO:root:TEST batch 1 / 2 - measures partial for class 0 - precision 1.0000 - recall 0.1058 - f1 0.1914 
INFO:root:TEST batch 1 / 2 - measures partial for class 1 - precision 0.0530 - recall 1.0000 - f1 0.1006 
INFO:root:TEST batch 1 / 2 - Batch time 14 
INFO:root:TEST batch 2 / 2 - partial error 0.8321 - partial loss 0.0614 - partial MRR  0.1539 - partial MAP 0.0533
INFO:root:TEST batch 2 / 2 -  partial tp {0: tensor(1845, device='cuda:0'), 1: tensor(648, device='cuda:0')},fn {0: tensor(11115, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(11115, device='cuda:0')}
INFO:root:TEST batch 2 / 2 - measures partial microavg - precision 0.1832 - recall 0.1832 - f1 0.1832 
INFO:root:TEST batch 2 / 2 - measures partial for class 0 - precision 1.0000 - recall 0.1424 - f1 0.2492 
INFO:root:TEST batch 2 / 2 - measures partial for class 1 - precision 0.0551 - recall 1.0000 - f1 0.1044 
INFO:root:TEST batch 2 / 2 - Batch time 13 
INFO:root:TEST mean losses tensor(0.0614, device='cuda:0')
INFO:root:TEST mean errors 0.8320541381835938
INFO:root:TEST mean MRR 0.15387462304183785 - mean MAP 0.05329303765041202
INFO:root:TEST tp {0: tensor(2916, device='cuda:0'), 1: tensor(1154, device='cuda:0')},fn {0: tensor(20164, device='cuda:0'), 1: tensor(0, device='cuda:0')},fp {0: tensor(0, device='cuda:0'), 1: tensor(20164, device='cuda:0')}
INFO:root:TEST measures microavg - precision 0.1679 - recall 0.1679 - f1 0.1679 
INFO:root:TEST measures for class 0 - precision 1.0000 - recall 0.1263 - f1 0.2243 
INFO:root:TEST measures for class 1 - precision 0.0541 - recall 1.0000 - f1 0.1027 
INFO:root:TEST measures@10 microavg - precision 0.5000 - recall 0.0008 - f1 0.0016 
INFO:root:TEST measures@10 for class 0 - precision 1.0000 - recall 0.0009 - f1 0.0017 
INFO:root:TEST measures@10 for class 1 - precision 0.0000 - recall 0.0000 - f1 0.0000 
INFO:root:TEST measures@100 microavg - precision 0.5200 - recall 0.0086 - f1 0.0169 
INFO:root:TEST measures@100 for class 0 - precision 1.0000 - recall 0.0087 - f1 0.0172 
INFO:root:TEST measures@100 for class 1 - precision 0.0400 - recall 0.0069 - f1 0.0118 
INFO:root:TEST measures@1000 microavg - precision 0.5268 - recall 0.0869 - f1 0.1493 
INFO:root:TEST measures@1000 for class 0 - precision 1.0000 - recall 0.0867 - f1 0.1595 
INFO:root:TEST measures@1000 for class 1 - precision 0.0535 - recall 0.0927 - f1 0.0679 
INFO:root:TEST Total epoch time: 28.15305739734322
INFO:root:################ TRAIN epoch 8 ###################
